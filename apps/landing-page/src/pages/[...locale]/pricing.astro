---
export const prerender = true;

import StickyNavbar from "@/components/StickyNavbar.astro";
import Landing from "@/layouts/Landing.astro";
import Footer from "@/sections/Footer.astro";
import PricingAnalytics from "@/sections/pricing-page/PricingAnalytics.astro";
import PricingAutomation from "@/sections/pricing-page/PricingAutomation.astro";
import PricingCoreFeatures from "@/sections/pricing-page/PricingCoreFeatures.astro";
import PricingEnterprise from "@/sections/pricing-page/PricingEnterprise.astro";
import PricingFAQ from "@/sections/pricing-page/PricingFAQ.astro";
import PricingFreeTier from "@/sections/pricing-page/PricingFreeTier.astro";
import PricingHero from "@/sections/pricing-page/PricingHero.astro";
import PricingPlanning from "@/sections/pricing-page/PricingPlanning.astro";
import PricingPlansGrid from "@/sections/pricing-page/PricingPlansGrid.astro";
import PricingSidebar from "@/sections/pricing-page/PricingSidebar.astro";
import PricingTeam from "@/sections/pricing-page/PricingTeam.astro";

export function getStaticPaths() {
   return [
      { params: { locale: undefined } },
      { params: { locale: "en" } },
      { params: { locale: "de" } },
      { params: { locale: "es" } },
   ];
}
---

<Landing>
   <StickyNavbar />

   <PricingHero />

   <div class="bg-background min-h-screen font-sans text-muted-foreground selection:bg-primary selection:text-primary-foreground">
      <!-- MAIN LAYOUT WITH SIDEBAR -->
      <div class="container mx-auto max-w-[1200px] px-4 pb-20">
         <div class="flex flex-col lg:flex-row gap-8">
            <PricingSidebar />

            <!-- MAIN CONTENT -->
            <main class="flex-1 space-y-16">
               <PricingFreeTier />
               <PricingPlansGrid />
               <PricingCoreFeatures />
               <PricingPlanning />
               <PricingAutomation />
               <PricingAnalytics />
               <PricingTeam />
               <PricingEnterprise />
               <PricingFAQ />
            </main>
         </div>
      </div>
   </div>

   <Footer />
</Landing>

<script>
   function syncToggles() {
      const mainToggle = document.getElementById('pricing-toggle') as HTMLInputElement;
      const sidebarToggle = document.getElementById('pricing-toggle-sidebar') as HTMLInputElement;
      const monthlyEls = document.querySelectorAll('.price-monthly');
      const yearlyEls = document.querySelectorAll('.price-yearly');

      function updatePrices(isYearly: boolean) {
         monthlyEls.forEach(el => el.classList.toggle('hidden', isYearly));
         yearlyEls.forEach(el => el.classList.toggle('hidden', !isYearly));
      }

      if (mainToggle && sidebarToggle) {
         mainToggle.addEventListener('change', (e) => {
            const isYearly = (e.target as HTMLInputElement).checked;
            sidebarToggle.checked = isYearly;
            updatePrices(isYearly);
         });

         sidebarToggle.addEventListener('change', (e) => {
            const isYearly = (e.target as HTMLInputElement).checked;
            mainToggle.checked = isYearly;
            updatePrices(isYearly);
         });

         updatePrices(mainToggle.checked);
      }
   }

   document.addEventListener('DOMContentLoaded', syncToggles);
   document.addEventListener('astro:page-load', syncToggles);
</script>
